{"version":3,"sources":["../src/Collection.js"],"names":["collections","Collection","constructor","name","opts","trim","fields","driver","cache","length","Error","Object","keys","create","classes","Live","Cached","className","cached","undefined","get","createDocument","initialValues","Model","formatIn","input","formatOut","doc","findById","id","find","query","updateById","data","deleteById"],"mappings":"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","sourcesContent":["import DocumentsLive from \"./CollectionTypes/DocumentsLive\"\r\nimport DocumentsCached from \"./CollectionTypes/DocumentsCached\"\r\nimport Model from './Model'\r\n\r\nconst collections = {}\r\n\r\n/**\r\n * Handles a collection.\r\n */\r\nexport default class Collection {\r\n    /**\r\n     * Creates a collection object, according to the configuration.\r\n     * \r\n     * @param {string} name Collection name\r\n     * @param {object} opts Options\r\n     */\r\n    constructor(name, opts) {\r\n        this.name = ((name ?? '') + '').trim()\r\n        this.fields = opts.fields ?? {}\r\n        this.driver = opts.driver ?? null\r\n        this.cache = []\r\n\r\n        if (this.name.length === 0) {\r\n            throw new Error('Missing collection name.')\r\n        }\r\n\r\n        if (Object.keys(this.fields).length === 0) {\r\n            throw new Error('Missing fields.')\r\n        }\r\n\r\n        if (this.driver === null) {\r\n            throw new Error('Missing driver.')\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a collection, and caches the configuration.\r\n     * \r\n     * @param {string} name Collection name\r\n     * @param {object} opts Options\r\n     */\r\n    static create(name, opts) {\r\n        const classes = {\r\n            Live,\r\n            Cached\r\n        }\r\n        const className = opts.cached ? 'DocumentsCached' : 'DocumentsLive'\r\n        if (classes[className] === undefined) {\r\n            throw new Error(`Collection type \"${className}\" does not exists.`)\r\n        }\r\n\r\n        collections[name] = new classes[className](name, opts)\r\n\r\n        return collections[name]\r\n    }\r\n\r\n    /**\r\n     * Retrieves an existing collection, or returns null.\r\n     * \r\n     * @param {string} name Collection name\r\n     * @returns Collection\r\n     */\r\n    static get(name) {\r\n        return collections[name] ?? null\r\n    }\r\n\r\n    async createDocument(initialValues = {}) {\r\n        return new Model(this.name, initialValues, this.driver)\r\n    }\r\n\r\n    async formatIn(input) {\r\n        throw new Error('Method formatIn not implemented on current collection type.')\r\n    }\r\n\r\n    async formatOut(doc) {\r\n        throw new Error('Method formatOut not implemented on current collection type.')\r\n    }\r\n\r\n    async findById(id) {\r\n        throw new Error('Method findById not implemented on current collection type.')\r\n    }\r\n\r\n    async find(query) {\r\n        throw new Error('Method find not implemented on current collection type.')\r\n    }\r\n\r\n    async updateById(id, data) {\r\n        throw new Error('Method updateById not implemented on current collection type.')\r\n    }\r\n\r\n    async deleteById(id) {\r\n        throw new Error('Method deleteById not implemented on current collection type.')\r\n    }\r\n\r\n    async create(data) {\r\n        throw new Error('Method create not implemented on current collection type.')\r\n    }\r\n}"],"file":"Collection.js"}